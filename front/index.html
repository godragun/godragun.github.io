<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome - Portfolio</title>
    <meta name="description" content="Harendra Thennakoon - Computer Engineering Student & Future Innovator">
    
    <!-- Enhanced Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://prod.spline.design; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; connect-src 'self' https://prod.spline.design https://unpkg.com;">
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="require-corp">
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), interest-cohort=()">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Welcome text in background -->
    <div class="welcome-text">WELCOME</div>
    
    <!-- Security Layer 3: Obfuscated Spline Integration -->
    <script type="module" src="https://unpkg.com/@splinetool/viewer@1.10.64/build/spline-viewer.js"></script>
    <div id="secure-3d-container" style="width: 100%; height: 100vh; position: absolute; top: 0; left: 0; z-index: 2;">
        <!-- 3D content will be loaded securely here -->
    </div>
    
    <!-- Security Layer 4: Dynamic Secure Loading -->
    <script>
        (function() {
            'use strict';
            
            // Encrypted and obfuscated URL components
            const secureComponents = {
                base: btoa('aHR0cHM6Ly9wcm9kLnNwbGluZS5kZXNpZ24v').split('').reverse().join(''),
                path: btoa('cjVtcVFuTlUzb2ZNO4d3Ny9zY2VuZS5zcGxpbmVjb2Rl').split('').reverse().join(''),
                script: btoa('aHR0cHM6Ly91bnBrZy5jb20vQHNwbGluZXRvb2wvdmlld2VyQDEuMTAuNjQvYnVpbGQvc3BsaW5lLXZpZXdlci5qcw==').split('').reverse().join('')
            };
            
            function decryptComponent(encrypted) {
                return atob(encrypted.split('').reverse().join(''));
            }
            
            function loadSecureSpline() {
                // Domain verification
                const allowedDomains = ['godragun.github.io', 'localhost'];
                const currentDomain = window.location.hostname;
                
                if (!allowedDomains.some(domain => currentDomain.includes(domain))) {
                    console.warn('Unauthorized domain');
                    return;
                }
                
                // Rate limiting
                if (window.splineLoadAttempts >= 3) {
                    console.warn('Too many load attempts');
                    return;
                }
                window.splineLoadAttempts = (window.splineLoadAttempts || 0) + 1;
                
                // Create secure spline viewer
                const container = document.getElementById('secure-3d-container');
                if (!container) return;
                
                const splineViewer = document.createElement('spline-viewer');
                splineViewer.setAttribute('url', decryptComponent(secureComponents.base) + decryptComponent(secureComponents.path));
                splineViewer.setAttribute('loading', 'eager');
                splineViewer.setAttribute('crossorigin', 'anonymous');
                splineViewer.style.cssText = 'width: 100%; height: 100vh; display: block; position: absolute; top: 0; left: 0; z-index: 2;';
                
                // Add error handling
                splineViewer.addEventListener('error', function() {
                    console.warn('Spline loading failed, showing fallback');
                    container.style.display = 'none';
                    const fallback = document.getElementById('fallback-3d');
                    if (fallback) {
                        fallback.style.display = 'block';
                        if (window.initFallback3D) window.initFallback3D();
                    }
                });
                
                container.appendChild(splineViewer);
                
                // Check loading status
                setTimeout(() => {
                    if (!splineViewer.shadowRoot || splineViewer.shadowRoot.children.length === 0) {
                        splineViewer.dispatchEvent(new Event('error'));
                    }
                }, 10000);
            }
            
            // Initialize on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', loadSecureSpline);
            } else {
                loadSecureSpline();
            }
        })();
    </script>
    
    <!-- Fallback 3D scene using Three.js -->
    <div id="fallback-3d" style="display: none; width: 100%; height: 100vh; position: absolute; top: 0; left: 0; z-index: 2;">
        <canvas id="three-canvas"></canvas>
    </div>
    
    <!-- Navigation -->
    <nav class="navigation">
        <ul>
            <li><a href="../index.html">Portfolio</a></li>
            <li><a href="../index.html#profile">Profile</a></li>
            <li><a href="../index.html#skills">Skills</a></li>
            <li><a href="../index.html#projects">Projects</a></li>
            <li><a href="../index.html#contact">Contact</a></li>
        </ul>
    </nav>

    <!-- Navigation JavaScript -->
    <script>
        // Enhanced navigation for front page
        document.addEventListener('DOMContentLoaded', function() {
            const navigationLinks = document.querySelectorAll('.navigation a');

            navigationLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    // If it's a hash link (section navigation), handle it specially
                    if (this.getAttribute('href').includes('#')) {
                        e.preventDefault();
                        const href = this.getAttribute('href');

                        // Navigate to the main page with the hash
                        window.location.href = href;
                    }
                });
            });
        });
    </script>
    
    <!-- Scroll indicator -->
    <div class="scroll-indicator">
        <div class="scroll-arrow"></div>
        <div>Scroll Down</div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>
